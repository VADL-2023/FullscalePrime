project(main_driver)
cmake_minimum_required(VERSION 3.18)
include_directories(include)

add_executable(exampleProject src/example.cpp)
add_executable(stepper1Test src/unit_tests/stepper1_test.cpp)
add_executable(stepper2Test src/unit_tests/stepper2_test.cpp)
add_executable(stepper3Test src/unit_tests/stepper3_test.cpp)
add_executable(rcbMotorTest src/unit_tests/rcb_motor_test.cpp)
add_executable(nacelleServoTest src/unit_tests/nacelle_servo_test.cpp)
add_executable(liftServoTest src/unit_tests/lift_servo_test.cpp)
add_executable(levelServoTest src/unit_tests/level_servo_test.cpp)
add_executable(liftMotorTest src/unit_tests/lift_motor_test.cpp)
add_executable(displayTest src/integration_tests/display.cpp)

target_link_libraries(exampleProject HFSM)
target_link_libraries(stepper1Test HFSM pigpio)
target_link_libraries(stepper2Test HFSM pigpio)
target_link_libraries(stepper3Test HFSM pigpio)
target_link_libraries(displayTest HFSM pigpio)
target_link_libraries(nacelleServoTest HFSM pigpio)
target_link_libraries(liftServoTest HFSM pigpio)
target_link_libraries(levelServoTest HFSM pigpio)
target_link_libraries(rcbMotorTest HFSM pigpio)
target_link_libraries(liftMotorTest HFSM pigpio)

set(THREADS_PREFER_PTHREAD_FLAG ON)
find_package(Threads REQUIRED)
target_link_libraries(exampleProject ${CMAKE_THREAD_LIBS_INIT})
target_link_libraries(stepper1Test ${CMAKE_THREAD_LIBS_INIT})
target_link_libraries(stepper2Test ${CMAKE_THREAD_LIBS_INIT})
target_link_libraries(stepper3Test ${CMAKE_THREAD_LIBS_INIT})
target_link_libraries(displayTest ${CMAKE_THREAD_LIBS_INIT})
target_link_libraries(rcbMotorTest ${CMAKE_THREAD_LIBS_INIT})
target_link_libraries(nacelleServoTest ${CMAKE_THREAD_LIBS_INIT})
target_link_libraries(liftServoTest ${CMAKE_THREAD_LIBS_INIT})
target_link_libraries(levelServoTest ${CMAKE_THREAD_LIBS_INIT})
target_link_libraries(liftMotorTest ${CMAKE_THREAD_LIBS_INIT})